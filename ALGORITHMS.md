# 物理算法说明 (Algorithms & Physics)

本项目采用高精度非相对论 Hartree-Fock (HF) 理论框架，专注于原子序数 $Z=1$ 到 $Z=36$ (氢到氪) 的原子轨道与杂化轨道可视化。

## 1. 原子轨道基组 (Basis Sets)

### 1.1 Koga-Thakkar 高精度 STO 基组
本项目弃用了传统的单指数 Slater 定则 (Slater's Rules) 近似，转而采用 **Koga & Thakkar (1999/2000)** 开发的高精度 Slater-Type Orbital (STO) 基组。
- **精度**：对于 $Z \le 36$ 的所有原子，该基组的总能量误差在 $10^{-7} E_h$ 数量级，极大程度接近 Hartree-Fock 极限。
- **形式**：波函数表示为多个 STO 的线性叠加：
  $$R_{nl}(r) = \sum_{i} c_i N_i r^{n^*_i-1} e^{-\zeta_i r}$$
  其中 $N_i$ 是归一化系数，$c_i$ 是由自洽场 (SCF) 计算优化的系数。

### 1.2 截断逻辑 (Z=1-36)
考虑到相对论效应在重原子中的显著影响（如金原子的 1s 轨道收缩约 22%），本项目将范围限制在非相对论理论仍保持极高精度的 $Z \le 36$ 区域。对于氪 (Kr, $Z=36$)，相对论引起的轨道收缩仅为 ~4-5%，在视觉表现上与非相对论模型基本一致。

## 2. 能量解析积分 (Analytical Energy Integration)

为了消除数值积分带来的噪点和不稳定性，本项目实现了基于**下不完全伽马函数 (Lower Incomplete Gamma Function)** 的解析积分框架。

### 2.1 势能积分 $V(R)$
$$V(R) = \int_{0}^{R} \psi^* \left( -\frac{Z}{r} \right) \psi r^2 dr$$
通过代入 STO 线性组合，该积分被转化为一系列形式为 $\int r^k e^{-\alpha r} dr$ 的项，利用解析解：
$$\int_{0}^{R} r^k e^{-\alpha r} dr = \frac{\gamma(k+1, \alpha R)}{\alpha^{k+1}}$$

### 2.2 动能积分 $T(R)$
利用动能算符在 STO 上的解析作用：
$$\hat{T} \chi(n, \zeta) = -\frac{1}{2} \left[ \frac{n(n-1) - l(l+1)}{r^2} - \frac{2n\zeta}{r} + \zeta^2 \right] \chi(n, \zeta)$$
结合不完全伽马函数，实现了对累积动能的 100% 精确解析求解。

## 3. 杂化轨道几何优化

本项目采用动态几何优化算法处理杂化轨道：
1. **Thomson 优化**：使用静电排斥模型在球面上寻找 $N$ 个能量最低的方向。
2. **SVD 正交化**：通过奇异值分解 (SVD) 求解从原子轨道基到底方角向基的变换矩阵，确保生成的杂化轨道不仅空间指向最优，且相互严格正交且归一化。
3. **干涉项处理**：在计算径向分布时，完整保留了同角向轨道（如 2s, 3s）之间的相干叠加项，确保了物理上的严谨性。
