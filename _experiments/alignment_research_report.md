# 杂化轨道自适应对齐算法研究报告

**日期**: 2025-12-28
**研究对象**: 杂化轨道几何构型与各向异性基组的自动对齐算法
**验证工具**: `_experiments/research_hybrid_alignment.py`
**核心方法**: 最大化基组投影矩阵的体积（行列式/奇异值乘积）

## 1. 核心思想

用户拒绝了硬编码（Hardcoding）和降级（Fallback）方案。因此，我们必须寻找一种**通用算法**，能够让随机生成的几何构型（Thomson Points）自动在这个物理世界中找到“最舒适”的姿态（即与给定的基组最匹配的方向）。

我们定义的对齐指标是**基组在目标方向上的投影矩阵的“体积”**。
若 $A_{ij} = \phi_j(\vec{r}_i)$，则目标函数为：
$$ \text{Maximize } \det(A^T A) \approx \prod \sigma_i(A) $$

物理意义：当几何构型与基组主轴对齐时，基函数能最有效地线性组合出指向这些构型的轨道，此时矩阵的秩最高，奇异值分布最健康。

## 2. 实验结果 (Python 验证)

### 2.1. sp3d (三角双锥 TBP)
*   **对齐前**：由于 TBP 轴向随机，与 Z 轴有夹角，导致 $d_{z^2}$ 无法有效参与轴向成键，SVD 强行混合导致成分混乱。
*   **对齐后**：
    *   **Axial (轴向)**: 几乎对齐到 Z 轴 ($\pm 1.0$).
        *   成分：$s$ (0.40), $p_z$ (0.71), $d_{z^2}$ (0.58).
    *   **Equatorial (赤道)**: 几乎处于 XY 平面 ($Z \approx 0$).
        *   成分：$s$ (0.48), $p_z$ (0.00), $d_{z^2}$ (-0.33).
    *   **物理合理性**: $d_{z^2}$ 主要贡献给轴向（正相位大瓣），赤道方向为负相位环（小瓣），符合 $d_{z^2} \propto 3z^2-r^2$ 的物理图像。

### 2.2. sp3d2 (八面体 Octahedral)
*   **对齐前**：Vol Index = 1.33e-1。
*   **对齐后**：Vol Index = 2.72e-1 (提升一倍)。
*   **结果**:
    *   **Z轴键**: 纯 $p_z + d_{z^2}$。
    *   **X轴键**: 纯 $p_x + d_{x^2-y^2}$ (正系数)。
    *   **Y轴键**: 纯 $p_y + d_{x^2-y^2}$ (负系数)。
    *   **清晰解耦**: 这是接近教科书的杂化结果，由算法自动寻优得到，无需硬编码。

## 3. 结论

**算法可行。**
可以通过引入一个轻量级的优化步骤（寻找最佳旋转矩阵 $R$），解决 Thomson 几何的随机性问题。

## 4. 迁移计划 (To Physics.js)

虽然 JS 中没有 `scipy.optimize`，但这是一个低维优化问题（3个欧拉角，或者四元数）。
1.  **梯度下降 / Nelder-Mead / 爬山法**: 由于我们只需要粗对齐（通常只有几个离散的极值点），简单的随机重启爬山法 (Random Restart Hill Climbing) 就足够了。
2.  **实现步骤**:
    *   生成 Thomson 点。
    *   尝试 N 个随机旋转（例如 20 个）。
    *   对每个旋转计算矩阵 $A$ 的奇异值乘积 (或者 $|\det|$)。
    *   取最优旋转作为最终构型。
    *   然后进行 SVD 正交化。
