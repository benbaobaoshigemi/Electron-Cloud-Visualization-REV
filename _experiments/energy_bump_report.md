# 核心轨道能量“正值鼓包”问题调查报告

## 1. 现象确认
在 Se (Z=34) 4s 轨道的累积能量 $E(r) = \int_0^r \rho_E(r') dr'$ 曲线中，发现在近核处（$r \to 0$）存在一个明显的正值上升区域（"鼓包"），导致累积能量先升至正值（约 +0.0104 Ha），然后再下降为负值。

## 2. 数学分析
通过 `_experiments/analyze_cusp.py` 对 Koga 基组参数进行解析导数分析，计算了波函数在原点处的行为。

**Kato Cusp Condition (卡托扭点条件)** 指出，对于真实的精确波函数，在该处的电子应该满足：
$$ \frac{\Psi'(0)}{\Psi(0)} = -Z_{nucleus} $$
即波函数的对数导数斜率应该完全由核电荷决定，以抵消势能的奇异性。

**分析结果：**
- **实际核电荷 (Z_nucleus)**: 34.0
- **基组有效核电荷 (Effective Cusp Z)**: $Z_{cusp} \approx 36.25$
  - 计算公式：$Z_{cusp} = -\frac{\sum c_i \nabla \phi_i(0)}{\sum c_i \phi_i(0)}$

## 3. 物理极理解释
局域能量密度（Local Energy）在原点附近的行为如下：
$$ E_{loc}(r) = \frac{\hat{H}\Psi}{\Psi} = T_{loc}(r) + V_{loc}(r) $$

- **势能项**: $V_{loc}(r) = -\frac{Z_{actual}}{r} = -\frac{34}{r}$
- **动能项**: 对于 $e^{-Z_{cusp}r}$ 形式的波函数，近核处动能主导项为 $+\frac{Z_{cusp}}{r} = +\frac{36.25}{r}$

**总局域能量**:
$$ E_{loc}(r) \approx \frac{Z_{cusp} - Z_{actual}}{r} = \frac{36.25 - 34.0}{r} = \frac{+2.25}{r} $$

由于 $Z_{cusp} > Z_{actual}$，导致在 $r \to 0$ 处存在一个发散的**正能量密度**。这就是“鼓包”的来源。

## 4. 验证：剔除动能项测试
为了进一步证实该结论，我们进行了一项对比测试：**仅计算势能项 $V(r)$ 的累积能量**，强制忽略动能项 $T(r)$。
- **预期**：势能 $V = -Z/r$ 恒为负，其累积值应单调下降（负值绝对值增加），**绝不应出现正值鼓包**。
- **结果**：运行脚本 `_experiments/check_se_4s_potential_only.py` 后，确认累积能量曲线完全位于 x 轴下方（Max Cumulative Energy $\le 0$）。
- **结论**：正值鼓包完全源于动能项，且正是由于基组在原点处的“过陡”（Over-binding）导致的动能过高（$T_{loc} \sim +Z_{cusp}/r > |V_{loc}|$）。

## 5. 结论
这个“离谱的正值鼓包”并非程序计算错误，而是 **Koga Slater-Type Orbital (STO) 基组本身的特性**。
该基组在优化时并未强制约束 Cusp Condition，而是为了最小化整体能量。在近核区域，基组为了更好地描述极其收缩的 core 电子，似乎采用了比标称 Z 更陡峭的指数（Over-binding），导致了局部的物理图像失真。

## 5. 建议
这是一个已知的基组截断/优化误差（Basis Set Artifact）。
- **选项 A (推荐)**: 接受该现象。这是近似波函数的真实表现。在此处强行平滑会掩盖基组的缺陷。
- **选项 B**: 在可视化中进行“美容”。检测 $r < 10^{-3}$ 的区域，如果发现 $dE/dr > 0$ 且相关系数显示是 Cusp 误差，则强制抹平（不推荐，违反科学严谨性）。
